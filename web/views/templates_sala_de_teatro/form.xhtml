<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"  
      xmlns:h="http://xmlns.jcp.org/jsf/html"  
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <ui:include src="../helpers/header.xhtml">
        <ui:param name="title" value="Sala De Teatro"/>
    </ui:include>
    <ui:include src="../helpers/navbar.xhtml"/>
    <h:body>
        <div class="ui text container">
            <center>
                <h1>
                    #{salaDeTeatroBean.operacao}
                </h1>
            </center>
            <h:form class="ui form" id="form">

                <div class="field">
                    <h:outputLabel for="nome">#{msg['teatro.list.nome']}</h:outputLabel>  
                    <h:inputText value="#{salaDeTeatroBean.saladeteatro.nome}" id="nome_peca" maxlength="30" a:placeholder="Aladdin" >
                        <f:validateRequired/>
                    </h:inputText>
                </div>
                <div class="field">
                    <h:outputLabel for="email">#{msg['teatro.list.email']}</h:outputLabel>  
                    <h:inputText value="#{salaDeTeatroBean.saladeteatro.email}" id="email" maxlength="30" a:placeholder="email@email.com" >
                        <f:validateRequired/>
                    </h:inputText>
                </div>
                <div class="field">
                    <h:outputLabel for="senha">#{msg['login.placeholder.password']}</h:outputLabel>   
                    <h:inputSecret value="#{salaDeTeatroBean.saladeteatro.senha}" id="senha" a:placeholder="******" maxlength="20">
                        <f:validateRequired/>
                    </h:inputSecret>
                </div>
                <div class="field">
                    <h:outputLabel for="cnpj">#{msg['teatro.list.cnpj']}</h:outputLabel>   
                    <h:inputText value="#{salaDeTeatroBean.saladeteatro.cnpj}" id="cnpj" styleClass="cnpj" maxlength="20" a:placeholder="99.999.999/9999-99">
                        <f:validateRequired/>
                    </h:inputText>
                </div>
                <div class="field">
                    <h:outputLabel for="cidade">#{msg['teatro.list.cidade']}</h:outputLabel>   
                    <h:inputText value="#{salaDeTeatroBean.saladeteatro.cidade}" id="cidade" maxlength="30" a:placeholder="JundiaÃ­">
                        <f:validateRequired/>
                    </h:inputText>
                    <div class="ui negative message hidden">
                        <p>#{msg['allform.error']}</p>
                    </div>
                    <h:commandButton value="Submit" action="#{salaDeTeatroBean.salva()}" class="ui positive button"/>
                </div>
            </h:form>
        </div>
        <h:outputScript library="js" name="jquery.mask.min.js" />

        <script>
            
            jQuery("input.cnpj").mask("99.999.999/9999-99");
            $(document).ready(function () {
                
                form = $('.ui.form');
                id_teatro = $('#id_teatro');
                nome_peca = $('#nome_peca');
                email = $('#email');
                senha = $('#senha');
                cnpj = $('#cnpj');
                cidade = $('#cidade');
                action = form.attr('action');
                
                cnpj.on("keyup", function(e)
{
                    $(this).val(
                        $(this).val()
                        .replace(/\D/g, '')
                        .replace(/^(\d{2})(\d{3})?(\d{3})?(\d{4})?(\d{2})?/, "$1 $2 $3/$4-$5"));
                });
                
                form.form({
                    fields: {
                        nome_peca: {
                            identifier: 'nome_peca',
                            rules: [
                                {
                                    type: 'empty',
                                    prompt: '#{msg['allform.required']}'
                                }
                            ]
                        },
                        email: {
                            identifier: 'email',
                            rules: [
                                {
                                    type: 'empty',
                                    prompt: '#{msg['allform.required']}'
                                }
                            ]
                        },
                        senha: {
                            identifier: 'senha',
                            rules: [
                                {
                                    type: 'empty',
                                    prompt: '#{msg['allform.required']}'
                                }
                            ]
                        },
                        cnpj: {
                            identifier: 'cnpj',
                            rules: [
                                {
                                    type: 'empty',
                                    prompt: '#{msg['allform.required']}'
                                }
                            ]
                        },
                        cidade: {
                            identifier: 'cidade',
                            rules: [
                                {
                                    type: 'empty',
                                    prompt: '#{msg['allform.required']}'
                                }
                            ]
                        },
                    },
                    on: 'blur',
                    inline: true,
                    onSuccess: function () {
                        form.removeClass('success').removeClass('error');
                    },
                    onFailure: function () {
                        window.scrollTo(0, 0);
                        form.removeClass('success').removeClass('error');
                    }
                }).on('submit', function (e) {
                    //e.preventDefault();
                    if (!form.form('is valid'))
                        return;
                    form.addClass('loading');
                    if(id_teatro.text() == "")
                    {
                        novo_id = 0;
                    }
                    $.post(action, {
                        nome_peca: nome_peca.val(),
                        email: email.val(),
                        senha: senha.val(),
                        cnpj: cnpj.val(),
                        cidade: cidade.val(),
                        id: novo_id
                    }).done(function () {
                        form.removeClass('loading');
                        form.trigger("reset");
                    }).fail(function () {
                        form.removeClass('loading');
                        $('.ui.message').show();
                    });
                });
            }
            );
        </script>
        <ui:include src="../helpers/footer.xhtml"/>
    </h:body>
</html>

